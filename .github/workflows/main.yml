name: GitHub个人资料统计生成

on:
  # 移除 push 触发器或修改为更具体条件
  # push:
  #   branches:
  #     - main
  schedule:
    # 设置为每天中午12点(UTC)运行，即北京时间晚上8点
    - cron: "0 12 * * *"
  # 允许手动触发工作流
  workflow_dispatch:

jobs:
  github-metrics:
    name: 生成GitHub统计数据
    runs-on: ubuntu-latest
    steps:
      - name: 生成GitHub个人资料统计信息
        uses: lowlighter/metrics@latest
        with:
          # 认证与设置
          token: ${{ secrets.GH_TOKEN }}
          committer_token: ${{ secrets.GH_TOKEN }}
          user: Muxucao0812
          config_timezone: Asia/Shanghai
          
          # 基础模块
          base: header, activity, community, repositories, metadata
          
          # 美化配置 - 调整为大尺寸
          template: classic
          config_display: large  # 改为large而不是columns以获得更大的宽度
          config_order: base.header, isocalendar, languages, notable, habits, wakatime, lines, activity
          config_padding: 5%     # 减少内边距以利用更多空间
          
          # 编程语言统计（增强显示百分比）
          plugin_languages: yes
          plugin_languages_details: percentage
          plugin_languages_colors: github
          plugin_languages_threshold: 0%
          plugin_languages_limit: 10
          
          # 贡献日历
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year  # 改为半年显示以减少垂直空间占用
          
          # 编码习惯（显示每天编码时间分布）
          plugin_habits: yes
          plugin_habits_charts: yes
          plugin_habits_facts: yes
          plugin_habits_from: 200
          plugin_habits_days: 14
          
          # WakaTime统计（增强显示操作系统和时间分布）
          plugin_wakatime: yes
          plugin_wakatime_token: ${{ secrets.WAKATIME_API_KEY }}
          plugin_wakatime_days: 7
          plugin_wakatime_sections: time, languages, editors, os, projects
          plugin_wakatime_limit: 8
          plugin_wakatime_url: https://wakatime.com

          
          # 代码行统计（显示添加和删除了多少行代码）
          plugin_lines: yes
          plugin_lines_sections: repositories, history
          plugin_lines_repositories_limit: 5
          plugin_lines_history_limit: 5
          
          # 活动时间线（显示最近的贡献时间和内容）
          plugin_activity: yes
          plugin_activity_limit: 5
          plugin_activity_days: 14
          plugin_activity_filter: all
          plugin_activity_visibility: public
          plugin_activity_timestamps: yes
          
          # 显示值得注意的贡献
          plugin_notable: yes
          plugin_notable_from: organization
          plugin_notable_types: commit
          plugin_notable_repositories: yes
          
          # 输出文件设置
          output_action: commit
          committer_branch: main
          # 添加 [Skip GitHub Action] 标记到提交消息中
          committer_message: "📊 更新个人GitHub统计信息 [Skip GitHub Action]"